---
title: ğŸŸ¢åŒæ­¥ä¸å¼‚æ­¥
tags:
  - JavaScript
  - åŒæ­¥&å¼‚æ­¥
  - Promise
createTime: 2025/06/23 17:25:08
permalink: /article/wlod3cgi/
excerpt: ç®€å•èŠèŠå…³äºåŒæ­¥ä¸å¼‚æ­¥ï¼Œä»¥åŠPromiseçš„åŸºæœ¬ç”¨æ³•ã€é“¾å¼è°ƒç”¨ã€é™æ€æ–¹æ³•ã€async/awaitã€‚
---
# å‰ç«¯å¼€å‘ä¸­çš„åŒæ­¥ä¸å¼‚æ­¥ç¼–ç¨‹

## åŒæ­¥(Synchronous)ç¼–ç¨‹
::: tip ç‰¹ç‚¹
- ä»£ç æŒ‰é¡ºåºæ‰§è¡Œï¼Œä¸€è¡Œå®Œæˆåæ‰æ‰§è¡Œä¸‹ä¸€è¡Œ
- é˜»å¡å¼æ‰§è¡Œï¼Œåç»­ä»£ç å¿…é¡»ç­‰å¾…å½“å‰æ“ä½œå®Œæˆ
- é€‚ç”¨äºç®€å•ã€å¿«é€Ÿçš„æ“ä½œ
:::
ç¤ºä¾‹:
```js
console.log("ç¬¬ä¸€æ­¥");
console.log("ç¬¬äºŒæ­¥"); // å¿…é¡»ç­‰å¾…ç¬¬ä¸€æ­¥å®Œæˆ
console.log("ç¬¬ä¸‰æ­¥"); // å¿…é¡»ç­‰å¾…ç¬¬äºŒæ­¥å®Œæˆ
```

## å¼‚æ­¥(Asynchronous)ç¼–ç¨‹

::: tip ç‰¹ç‚¹
- ä»£ç ä¸æŒ‰ä¹¦å†™é¡ºåºæ‰§è¡Œ
- éé˜»å¡å¼æ‰§è¡Œï¼Œåç»­ä»£ç ä¸å¿…ç­‰å¾…å½“å‰æ“ä½œå®Œæˆ
- é€‚ç”¨äºè€—æ—¶æ“ä½œ(ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ç­‰)
:::
ç¤ºä¾‹:
```js
console.log("ç¬¬ä¸€æ­¥");
setTimeout(() => {
console.log("ç¬¬äºŒæ­¥"); // ä¼šåœ¨æœ€åæ‰§è¡Œ
}, 1000);
console.log("ç¬¬ä¸‰æ­¥"); // ä¸ä¼šç­‰å¾…setTimeout
```

## Promise ä»‹ç»

### åŸºæœ¬æ¦‚å¿µ
::: tip Promise
- è¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆå®Œæˆ(æˆ–å¤±è´¥)åŠå…¶ç»“æœå€¼
- ä¸‰ç§çŠ¶æ€: ==pending==(ç­‰å¾…)ã€==fulfilled==(å·²å®Œæˆ)ã€==rejected==(å·²æ‹’ç»)
- ä¸€æ—¦çŠ¶æ€æ”¹å˜å°±ä¸ä¼šå†å˜(ä»`pending`å˜ä¸º`fulfilled`æˆ–`rejected`)
:::
### åŸºæœ¬ç”¨æ³•

#### åˆ›å»ºPromise
```js
const myPromise = new Promise((resolve, reject) => {
// å¼‚æ­¥æ“ä½œ
if (/* æ“ä½œæˆåŠŸ */) {
resolve("æˆåŠŸç»“æœ");
} else {
reject("å¤±è´¥åŸå› ");
}
});
```

#### ä½¿ç”¨Promise
```js
myPromise
    .then(result => {
        console.log("æˆåŠŸ:", result);
    })
    .catch(error => {
        console.error("å¤±è´¥:", error);
    })
    .finally(() => {
        console.log("æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œ");
    });
```

### é“¾å¼è°ƒç”¨
::: tip é“¾å¼è°ƒç”¨
- then()æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„Promise
- å¯ä»¥è¿ç»­è°ƒç”¨å¤šä¸ªthen()
:::
ç¤ºä¾‹:
```js
fetchData()
    .then(data => processData(data))
    .then(processed => saveData(processed))
    .then(() => console.log("å…¨éƒ¨å®Œæˆ"))
    .catch(err => console.error("å‡ºé”™:", err));
```
### é™æ€æ–¹æ³•

#### `Promise.all()` <Badge text="ç­‰å¾…æ‰€æœ‰Promiseå®Œæˆ,å¦‚æœæœ‰ä¸€ä¸ªå¤±è´¥ï¼Œç«‹å³æ‹’ç»" type="tip"/>
```js
Promise.all([promise1, promise2, promise3])
    .then(values => {
        console.log(values); // [result1, result2, result3]
    });
```

#### `Promise.race()` <Badge text="è¿”å›æœ€å…ˆå®Œæˆ(æ— è®ºæˆåŠŸå¤±è´¥)çš„Promiseç»“æœ" type="warning"/>

```js
Promise.race([promise1, promise2])
    .then(value => {
        console.log(value); // æœ€å…ˆå®Œæˆçš„promiseçš„ç»“æœ
    });
```

#### `Promise.allSettled()` <Badge text="ç­‰å¾…æ‰€æœ‰Promiseå®Œæˆ,æ— è®ºæˆåŠŸå¤±è´¥" type="danger"/>

```js
Promise.allSettled([promise1, promise2])
    .then(results => {
        results.forEach(result => {
            if (result.status === "fulfilled") {
                console.log("æˆåŠŸ:", result.value);
            } else {
                console.log("å¤±è´¥:", result.reason);
            }
        });
    });
```

### async/await (åŸºäºPromiseçš„è¯­æ³•ç³–)

::: tip ç‰¹ç‚¹
- ä½¿å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç 
- asyncå‡½æ•°**æ€»æ˜¯è¿”å›Promise**
- await**åªèƒ½åœ¨asyncå‡½æ•°ä¸­ä½¿ç”¨**
:::
ç¤ºä¾‹:
```js
async function fetchData() {
    try {
        const response = await fetch('api/data');
        const data = await response.json();
        console.log(data);
        return data;
    } catch (error) {
        console.error("å‡ºé”™:", error);
        throw error;
    }
}
    
fetchData().then(data => {
    console.log("æœ€ç»ˆæ•°æ®:", data);
});
```

### Promise å¸¸è§ä½¿ç”¨åœºæ™¯
1. AJAX/fetchè¯·æ±‚
2. å®šæ—¶å™¨æ“ä½œ
3. æ–‡ä»¶è¯»å–(åœ¨Node.jsä¸­)
4. æ•°æ®åº“æ“ä½œ
5. ä»»ä½•éœ€è¦ç­‰å¾…çš„æ“ä½œ

### Promise æœ€ä½³å®è·µ
1. æ€»æ˜¯å¤„ç†é”™è¯¯(.catchæˆ–try/catch)
2. é¿å…PromiseåµŒå¥—(ä½¿ç”¨é“¾å¼è°ƒç”¨)
3. åœ¨asyncå‡½æ•°ä¸­åˆç†ä½¿ç”¨await
4. ä¸ºPromiseå‡½æ•°æ·»åŠ æœ‰æ„ä¹‰çš„åç§°
5. è€ƒè™‘ä½¿ç”¨Promise.allä¼˜åŒ–å¤šä¸ªå¹¶è¡Œè¯·æ±‚