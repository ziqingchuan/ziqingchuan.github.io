---
title: Vue的生命周期
createTime: 2025/06/24 15:00:43
permalink: /article/l0oy48ls/
tags:
  - Vue
  - 生命周期
excerpt: 还是只会用onMounted()吗？好好思考一下 Vue 的生命周期吧！
---
## 什么是生命周期？

Vue 的生命周期是指从 **创建一个 Vue 实例** 到 **实例被销毁** 的整个过程。在这个过程中，Vue 提供了多个生命周期钩子函数，开发者可以在这些函数中执行特定的逻辑，比如数据获取、DOM 操作、事件绑定等。

## Vue 生命周期的主要阶段

### 1. **创建阶段**
组件实例被创建，但尚未挂载到 DOM 上。在这个阶段，组件的响应式数据和事件监听器会被初始化，但还未涉及 DOM 的操作。

#### 对应的生命周期钩子：
- **`beforeCreate`**  
  - 这是生命周期的第一个钩子函数，组件实例刚刚被初始化，数据和事件尚未设置。
  - 在这个阶段访问 `data`、`props` 或 `methods` 都是==无效的=={.note}。

- **`created`**  
  - 响应式数据和事件监听器已经被初始化，但==组件还未挂载到 DOM=={.note}。
  - 通常在这个阶段用于：
  
    <Badge text="初始化数据" type="tip"/>
  
    <Badge text="获取异步数据" type="warning"/>

    <Badge text="设置定时器" type="danger"/>

> 💡 **提示**：此阶段无法访问 DOM，因此不要在此阶段进行 DOM 操作。

### 2. **挂载阶段**
组件已经准备好挂载到 DOM 上，但还未完成实际的渲染。

#### 对应的生命周期钩子：
- **`beforeMount`**  
  - 挂载动作即将开始，==模板已编译完成，但还未插入 DOM=={.note}。
  - 此时仍无法访问真实的 DOM。

- **`mounted`**  
  - 组件已经挂载完成，DOM 已经生成，==可以在此阶段操作 DOM=={.note}。
  - 常见用途：
  
    <Badge text="执行依赖 DOM 的操作" type="tip"/>

    <Badge text="绑定第三方插件（如图表库）" type="warning"/>


> ⚠️ **注意**：虽然可以在 `mounted` 中操作 DOM，但最好避免复杂的业务逻辑，这可能导致性能问题。

### 3. **更新阶段**
当组件的数据或属性发生变化时，组件会重新渲染并更新 DOM。

#### 对应的生命周期钩子：
- **`beforeUpdate`**  
  - 数据发生变化，组件即将重新渲染。
  - 此时，DOM 仍然是旧的状态。

- **`updated`**  
  - 组件完成重新渲染，DOM 已更新。
  - 此时可以操作更新后的 DOM，但应避免在此钩子中再次触发状态改变，避免死循环。

> ⚠️ **提示**：尽量避免频繁的 DOM 操作，并将逻辑分离到其他函数中。

### 4. **销毁阶段**
组件被销毁，实例中的所有绑定和事件监听器都会被移除。

#### 对应的生命周期钩子：
- **`beforeDestroy`**  
  - 组件即将销毁，==实例仍然可用=={.note}。
  - 常用操作：

    <Badge text="清除定时器" type="danger"/>

    <Badge text="解绑事件监听器" type="warning"/>

- **`destroyed`**  
  - 组件已经被销毁，所有资源和事件监听器都被清理。
  - 此阶段无法访问组件实例的任何属性。

## Vue 生命周期钩子函数总览

以下是 Vue 生命周期钩子函数的顺序和作用：

| 阶段             | 钩子函数        | 描述                                              |
|------------------|----------------|--------------------------------------------------|
| **创建阶段**      | `beforeCreate` | 实例初始化完成，尚未设置数据和事件。              |
|                  | `created`      | 数据和事件已初始化，但未挂载 DOM。                |
| **挂载阶段**      | `beforeMount`  | 模板已编译完成，尚未插入 DOM。                    |
|                  | `mounted`      | DOM 已插入，可进行 DOM 操作。                     |
| **更新阶段**      | `beforeUpdate` | 数据变化，组件即将重新渲染。                      |
|                  | `updated`      | 组件完成重新渲染，DOM 已更新。                    |
| **销毁阶段**      | `beforeDestroy`| 组件即将销毁，仍可访问实例。                      |
|                  | `destroyed`    | 组件已销毁，绑定事件和资源已清理。                |


## 生命周期的常见应用场景

### 1. **数据获取**
- **推荐阶段**：`created` 或 `mounted`  
  在 `created` 中获取数据可以确保在挂载之前完成初始化，而在 `mounted` 中获取数据则可以确保组件已经渲染到页面。

### 2. **DOM 操作**
- **推荐阶段**：`mounted`  
  在 `mounted` 中操作 DOM 是安全的，因为此时 DOM 已经完成挂载。

### 3. **事件监听**
- **推荐阶段**：`mounted`（绑定）和 `beforeDestroy`（解绑）  
  在组件销毁前解绑事件监听器以防止内存泄漏。

### 4. **定时器清理**
- **推荐阶段**：`beforeDestroy`  
  在组件销毁前清理定时器，避免无效的任务占用资源。

## 总结

Vue 的生命周期贯穿了组件的整个运行过程，从创建、挂载到更新和销毁。合理地利用生命周期钩子函数，可以帮助开发者更高效地编写业务逻辑，同时避免资源浪费和性能问题。

### **关键点回顾**
1. **创建阶段**：初始化数据和事件监听。
2. **挂载阶段**：访问 DOM，执行依赖 DOM 的逻辑。
3. **更新阶段**：响应数据变化，避免频繁的 DOM 操作。
4. **销毁阶段**：清理资源，移除事件监听器和定时器。
